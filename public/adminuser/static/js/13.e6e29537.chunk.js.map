{"version":3,"sources":["app/components/DragDrop/FileList/index.js","app/components/DragDrop/Upload/index.js","app/pages/AnuncioVideoPhotos/index.js"],"names":["FileList","files","Container","className","map","uploadedFile","Row","preview","Col","sm","style","width","height","borderRadius","backgroundImage","backgroundRepeat","backgroundSize","backgroundPosition","marginRight","name","url","href","target","rel","id","error","uploaded","progress","Progress","color","value","Upload","accept","message","messageReject","messageAccept","onUpload","renderDragMessage","isDragActive","isDragReject","onDropAccepted","getRootProps","getInputProps","border","cursor","transition","AnuncioVideoPhotos","navigate","useNavigate","animalId","useParams","useState","showButton","setShowButton","uploadedFiles","setUploadedFiles","uploadedFileVideo","setUploadedFileVideo","updateFile","fileId","data","isVideo","state","processUpload","uploadFile","FormData","append","file","api","post","onUploadProgress","e","parseInt","Math","round","loaded","total","console","log","then","response","fileData","_id","image_url","video_url","catch","useEffect","a","JSON","parse","localStorage","getItem","ANUNCIO_DATA","Card","CardHeader","CardBody","newFiles","uniqueId","readableSize","filesize","size","URL","createObjectURL","forEach","newFile","CardFooter","Button","onClick","removeItem"],"mappings":"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","file":"static/js/13.e6e29537.chunk.js","sourcesContent":["import React from 'react';\nimport { Row, Progress, Container, Col } from 'reactstrap';\n\nconst FileList = ({ files }) => (\n  <Container className=\"py-2\">\n    {files.map(\n      (uploadedFile) => uploadedFile && (\n      <Row className=\"align-items-center\" key={uploadedFile.id}>\n        {uploadedFile.preview && (\n        <Col sm={1}>\n          <div\n            style={{\n              width: '36px',\n              height: '36px',\n              borderRadius: '5px',\n              backgroundImage: `url(${uploadedFile.preview})`,\n              backgroundRepeat: 'no-repeat',\n              backgroundSize: 'cover',\n              backgroundPosition: '50% 50%',\n              marginRight: '10px',\n            }}\n          />\n        </Col>\n        )}\n        <Col>\n          <Row key={uploadedFile.id}>\n            <div>\n              <strong className=\"mr-2\">{uploadedFile.name}</strong>\n              {uploadedFile.url && (\n              <a\n                href={uploadedFile.url}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                <i className=\"fas fa-link\" />\n              </a>\n              )}\n              {/* <span>\n                  {uploadedFile.readableSize}\n                  {' '}\n                  {!!uploadedFile.url && (\n                    <Button color=\"danger\" size=\"sm\" onClick={() => onDelete(uploadedFile.id)}>\n                      Excluir\n                    </Button>\n                  )}\n                </span> */}\n            </div>\n          </Row>\n          <Row>\n            {uploadedFile.error && (\n            <small className=\"text-danger\">\n              <i className=\"fas fa-exclamation-circle mr-1\" />\n              Erro no upload. Tente enviar novamente.\n            </small>\n            )}\n\n            {!uploadedFile.error && !uploadedFile.uploaded && (\n            <div className=\"w-100\">\n              <small className=\"text-info mr-3\">\n                <i className=\"fas fa-file-upload mr-1\" />\n                Fazendo upload do arquivo\n              </small>\n              {uploadedFile.progress ? (\n                <Progress\n                  color=\"info\"\n                  value={uploadedFile.progress}\n                  style={{ height: '0.5rem' }}\n                />\n              ) : null}\n            </div>\n            )}\n\n            {uploadedFile.uploaded && (\n              <small className=\"text-success\">\n                <i className=\"fas fa-check-circle mr-1\" />\n                Upload concluido com sucesso\n              </small>\n            )}\n          </Row>\n        </Col>\n      </Row>\n      ),\n    )}\n  </Container>\n);\n\nexport default FileList;\n","/* eslint-disable no-nested-ternary */\nimport React from 'react';\nimport Dropzone from 'react-dropzone';\n\nexport default function Upload({\n  accept = 'image/*',\n  message = 'Selecione ou Arraste os arquivos aqui...',\n  messageReject = 'Arquivo não suportado',\n  messageAccept = 'Solte os arquivos aqui',\n  onUpload,\n}) {\n  const renderDragMessage = (isDragActive, isDragReject) => {\n    if (!isDragActive) {\n      return (\n        <p\n          className=\"d-flex justify-content-center align-items-center py-3\"\n          style={{ color: 'var(--dark)' }}\n        >\n          {message}\n        </p>\n      );\n    }\n\n    if (isDragReject) {\n      return (\n        <p\n          className=\"d-flex justify-content-center align-items-center py-3\"\n          style={{ color: 'var(--danger)' }}\n        >\n          {messageReject}\n        </p>\n      );\n    }\n\n    return (\n      <p\n        className=\"d-flex justify-content-center align-items-center py-3\"\n        style={{ color: 'var(--success)' }}\n      >\n        {messageAccept}\n      </p>\n    );\n  };\n\n  return (\n    <Dropzone accept={accept} onDropAccepted={onUpload}>\n      {({ getRootProps, getInputProps, isDragActive, isDragReject }) => (\n        <div\n          {...getRootProps()}\n          className=\"dropzone w-100\"\n          style={{\n            border: `1px dashed ${\n              isDragActive ? 'var(--success)'\n                : isDragReject ? 'var(--danger)' : ''\n            }`,\n            borderRadius: '0.75rem',\n            cursor: 'pointer',\n            transition: 'height 0.2s ease',\n          }}\n        >\n          <input {...getInputProps()} />\n          {renderDragMessage(isDragActive, isDragReject)}\n        </div>\n      )}\n    </Dropzone>\n  );\n}\n","import React, { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport {\n  Button,\n  Card,\n  CardBody,\n  CardHeader,\n  Col,\n  Container,\n  CardFooter,\n  Row,\n  // Fade,\n} from 'reactstrap';\n\nimport filesize from 'filesize';\nimport { uniqueId } from 'lodash';\n\nimport FileList from '../../components/DragDrop/FileList';\nimport Upload from '../../components/DragDrop/Upload';\nimport { ANUNCIO_DATA } from '../../constants/app';\nimport api from '../../services/api';\n\nfunction AnuncioVideoPhotos() {\n  const navigate = useNavigate();\n  const { id: animalId } = useParams();\n  const [showButton, setShowButton] = useState(false);\n  const [uploadedFiles, setUploadedFiles] = useState([]);\n  const [uploadedFileVideo, setUploadedFileVideo] = useState();\n\n  const updateFile = (fileId, data, isVideo) => {\n    if (isVideo) {\n      setUploadedFileVideo({ ...uploadedFileVideo, ...data });\n      return;\n    }\n\n    setUploadedFiles((state) => state.map(\n      (uploadedFile) => (fileId === uploadedFile.id ? { ...uploadedFile, ...data } : uploadedFile),\n    ));\n  };\n\n  const processUpload = (uploadFile, url, isVideo = false) => {\n    const data = new FormData();\n    data.append('file', uploadFile.file, uploadFile.name);\n\n    api\n      .post(url, data, {\n        onUploadProgress: (e) => {\n          const progress = parseInt(Math.round((e.loaded * 100) / e.total), 10);\n          console.log('progress upload', progress);\n          updateFile(uploadFile.id, { progress }, isVideo);\n        },\n      })\n      .then((response) => {\n        const { data: fileData } = response;\n        updateFile(uploadFile.id, {\n          uploaded: true,\n          id: fileData._id,\n          name: fileData.name,\n          url: fileData.image_url ? fileData.image_url : fileData.video_url,\n        }, isVideo);\n      })\n      .catch(() => {\n        updateFile(uploadFile.id, {\n          error: true,\n        }, isVideo);\n      });\n  };\n\n  const handleUpload = (files = []) => {\n    const newFiles = files.map((file) => ({\n      file,\n      id: uniqueId(),\n      name: file.name,\n      readableSize: filesize(file.size),\n      preview: URL.createObjectURL(file),\n      progress: 0,\n      uploaded: false,\n      error: false,\n      url: null,\n    }));\n\n    setUploadedFiles([...newFiles, ...uploadedFiles]);\n\n    newFiles.forEach((file) => processUpload(file, `/images/${animalId}/animals`));\n  };\n\n  const handleUploadVideo = (files = []) => {\n    if (uploadedFileVideo) {\n      return;\n    }\n\n    const file = files[0];\n    const newFile = {\n      file,\n      id: uniqueId(),\n      name: file.name,\n      readableSize: filesize(file.size),\n      // preview: URL.createObjectURL(file),\n      progress: 0,\n      uploaded: false,\n      error: false,\n      url: null,\n    };\n\n    setUploadedFileVideo(newFile);\n\n    processUpload(newFile, `/videos/${animalId}/animals`, true);\n  };\n\n  useEffect(() => {\n    (async () => {\n      try {\n        setShowButton(true);\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }, []);\n\n  const handlePrev = () => {\n    navigate('/anuncio-detalhes');\n  };\n\n  const handleFinish = () => {\n    localStorage.removeItem(ANUNCIO_DATA);\n    navigate('/anuncios');\n  };\n\n  useEffect(() => {\n    const data = JSON.parse(localStorage.getItem(ANUNCIO_DATA));\n    if (data) {\n      console.log(data);\n    }\n  }, []);\n\n  return (\n    <Container>\n      <Row>\n        <Col>\n          <Card>\n            <CardHeader>\n              <h3>Adicione Fotos e Vídeo</h3>\n            </CardHeader>\n          </Card>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Card>\n            <CardHeader>\n              <h5>Imagens</h5>\n            </CardHeader>\n            <CardBody>\n              <Container>\n                <Upload onUpload={handleUpload} />\n                <FileList files={uploadedFiles} />\n                {/* <FileList\n                  files={[\n                    {\n                      id: 10,\n                      preview:\n                        'https://s2.glbimg.com/V4XsshzNU57Brn3e127b80Rbk24=/e.glbimg.com/og/ed/f/original/2016/05/30/gado.jpg',\n                      url: 'https://s2.glbimg.com/V4XsshzNU57Brn3e127b80Rbk24=/e.glbimg.com/og/ed/f/original/2016/05/30/gado.jpg',\n                      name: 'animal bovino.jpg',\n                      progress: 33,\n                    },\n                  ]}\n                /> */}\n              </Container>\n            </CardBody>\n          </Card>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <Card>\n            <CardHeader>\n              <h5>Vídeo</h5>\n              <small>Envie apenas um vídeo</small>\n            </CardHeader>\n            <CardBody>\n              <Container>\n                {!uploadedFileVideo && (\n                  <Upload\n                    accept=\"video/*\"\n                    message=\"Selecione ou Arraste o arquivo aqui...\"\n                    messageAccept=\"Solte o arquivo aqui\"\n                    onUpload={handleUploadVideo}\n                  />\n                )}\n                <FileList files={[uploadedFileVideo]} />\n\n                {/* <FileList\n                  files={[\n                    {\n                      id: 11,\n                      name: 'animal bovino.mp4',\n                      progress: 33,\n                    },\n                  ]}\n                /> */}\n              </Container>\n            </CardBody>\n          </Card>\n        </Col>\n      </Row>\n      {showButton && (\n        <Row>\n          <Col>\n            <Card>\n              <CardFooter>\n                <Row className=\"justify-content-between px-3\">\n                  <Button onClick={handlePrev}>Anterior</Button>\n                  <Button onClick={handleFinish}>Finalizar</Button>\n                </Row>\n              </CardFooter>\n            </Card>\n          </Col>\n        </Row>\n      )}\n    </Container>\n  );\n}\n\nexport default AnuncioVideoPhotos;\n"],"sourceRoot":""}